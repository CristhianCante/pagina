<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo: Nueva Proyección Cartográfica para Colombia - Guía de PostGIS Bogotá</title>
    <!-- Tailwind CSS para un diseño rápido y responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilos para el contenido del artículo */
        .article-content h2 {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 800; /* extrabold */
            color: #1f2937; /* gray-800 */
            margin-top: 2.5rem; /* mt-10 */
            margin-bottom: 1rem; /* mb-4 */
            border-bottom: 2px solid #e5e7eb; /* border-gray-200 */
            padding-bottom: 0.5rem; /* pb-2 */
        }
        .article-content h3 {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 700; /* bold */
            color: #1f2937; /* gray-800 */
            margin-top: 2rem; /* mt-8 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .article-content p, .article-content ul, .article-content ol {
            font-size: 1.125rem; /* text-lg */
            color: #374151; /* gray-700 */
            line-height: 1.75;
            margin-bottom: 1rem;
        }
        .article-content ul {
            list-style-type: disc;
            padding-left: 2rem;
        }
        .article-content a {
            color: #2563eb; /* blue-600 */
            text-decoration: none;
            transition: color 0.2s;
        }
        .article-content a:hover {
            color: #1d4ed8; /* blue-800 */
            text-decoration: underline;
        }
        .article-content code:not(.hljs) { /* Código inline */
            background-color: #e5e7eb;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9em;
        }
        .code-block-container {
            position: relative;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .copy-button {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: #4b5563;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid #6b7280;
        }
        .copy-button:hover {
            background-color: #374151;
        }
        .copy-button.copied {
            background-color: #16a34a; /* green-600 */
        }
        .styled-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
        }
        .styled-table th, .styled-table td {
            border: 1px solid #d1d5db;
            padding: 0.75rem;
            text-align: left;
        }
        .styled-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        .styled-table tbody tr:nth-child(odd) {
            background-color: #f9fafb;
        }
    </style>
    <!-- Highlight.js para el resaltado de sintaxis SQL -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10">

        <!-- ===== NAVEGACIÓN DE VUELTA ===== -->
        <nav class="mb-6">
            <a href="index.html" class="text-blue-600 hover:text-blue-800 hover:underline transition-colors duration-200 text-lg">
                &larr; Volver a la página principal de la guía
            </a>
        </nav>

        <!-- ===== CABECERA DEL MÓDULO ===== -->
        <header class="mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-2">
                Nueva Proyección Cartográfica para Colombia
            </h1>
            <p class="text-xl text-gray-600">
                Entendiendo el Origen Nacional (EPSG:9377) y su manejo en PostGIS.
            </p>
        </header>

        <article class="bg-white p-6 sm:p-8 lg:p-12 rounded-xl shadow-md border border-gray-200 article-content">
            
            <h2>1. ¿Qué es una Proyección Cartográfica?</h2>
            <p>
                Una proyección cartográfica es un método matemático para representar la superficie curva de la Tierra sobre un plano. Este proceso es fundamental para crear mapas, pero inevitablemente introduce distorsiones en áreas, formas, distancias o direcciones. Ninguna proyección es perfecta; la elección de una u otra depende del propósito del mapa.
            </p>
            
            <h3>El Sistema Anterior en Colombia: Gauss-Krüger</h3>
            <p>
                Anteriormente, Colombia utilizaba una proyección Transversa de Mercator adaptada, conocida como Gauss-Krüger. Este sistema dividía el país en 6 zonas o husos, cada uno con su propio origen de coordenadas.
            </p>
            <img src="imagenes/Nueva proyección cartografica para colombia/imagen 1.png" alt="[Mapa de las antiguas zonas de proyección Gauss-Krüger en Colombia]" class="w-full max-w-lg mx-auto my-4 rounded-lg shadow-md border">
            <p>
                <strong>El principal problema</strong> era la ambigüedad: un mismo municipio o proyecto que se encontrara en el límite de dos zonas podía tener coordenadas diferentes dependiendo del sistema de referencia utilizado, lo que complicaba la integración de datos a nivel nacional.
            </p>

            <h2>2. La Nueva Proyección Oficial: Origen Nacional (EPSG:9377)</h2>
            <p>
                Para solucionar estos problemas y modernizar la gestión de datos geográficos, Colombia adoptó oficialmente una nueva proyección mediante la <strong>Resolución 471 de 2020 del IGAC</strong>. Este nuevo sistema, conocido como <strong>Origen Único Nacional</strong>, utiliza un solo punto de origen para todo el país.
            </p>
             <img src="imagenes/Nueva proyección cartografica para colombia/imagen 2.png" alt="[Mapa de la distorsión en áreas para la proyección Origen Nacional]" class="w-full max-w-lg mx-auto my-4 rounded-lg shadow-md border">
            <p>A este sistema unificado se le asignó el código internacional <strong>EPSG:9377</strong>, lo que garantiza su compatibilidad con software y bases de datos espaciales en todo el mundo.</p>

            <h3>2.1. Detalles Técnicos de la Proyección (EPSG:9377)</h3>
            <p>Los parámetros técnicos que definen el Origen Nacional son los siguientes:</p>
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Proyección</td><td>Transverse Mercator</td></tr>
                    <tr><td>Datum</td><td>MAGNA-SIRGAS</td></tr>
                    <tr><td>Latitud de origen</td><td>4° N</td></tr>
                    <tr><td>Longitud central (Meridiano central)</td><td>73° W</td></tr>
                    <tr><td>Falso Este</td><td>5,000,000 m</td></tr>
                    <tr><td>Falso Norte</td><td>2,000,000 m</td></tr>
                    <tr><td>Factor de escala</td><td>0.9992</td></tr>
                </tbody>
            </table>

            <h3>2.2. Ventajas del Origen Nacional</h3>
            <ul>
                <li><strong>Integración de datos:</strong> Facilita la consolidación de toda la información geográfica del país en una única base de datos con coordenadas planas.</li>
                <li><strong>Eliminación de ambigüedades:</strong> Se acaban los problemas de datos en los límites de las antiguas zonas.</li>
                <li><strong>Continuidad territorial:</strong> Permite representaciones continuas desde escalas grandes (1:1.000) hasta escalas regionales.</li>
                <li><strong>Interoperabilidad:</strong> Simplifica el intercambio de información entre diferentes entidades del estado y privadas.</li>
            </ul>

            <h2>3. Manejo de Proyecciones en PostGIS</h2>
            <p>
                La base de todo análisis espacial correcto es la consistencia en el sistema de referencia. PostGIS es estricto en este aspecto: si intentas realizar una operación espacial (como <code>ST_Intersects</code> o <code>ST_Distance</code>) entre dos geometrías que tienen diferentes SRID, PostGIS generará un error. Esto es una medida de seguridad para prevenir resultados incorrectos.
            </p>
            
            <h3>3.1. Verificando el SRID: ST_SRID()</h3>
            <p>Puedes verificar el SRID de una geometría con la función <code>ST_SRID()</code>.</p>
            <div class="code-block-container">
                <button class="copy-button">Copiar</button>
                <pre><code class="language-sql">-- Suponiendo que tenemos una tabla 'lotes_bogota'
SELECT ST_SRID(geom) FROM lotes_bogota LIMIT 1;</code></pre>
            </div>

            <h3>3.2. Transformando Geometrías: ST_Transform()</h3>
            <p>
                Para poder comparar o analizar geometrías con diferentes SRID, debes <strong>transformar</strong> una de ellas al sistema de referencia de la otra. La función clave para esto es <code>ST_Transform(geometria, nuevo_srid)</code>. Esta función recalcula las coordenadas de la geometría para que coincidan con el nuevo sistema.
            </p>
            <p><strong>Ejemplo:</strong> Transformar una geometría del antiguo sistema CTM-12 (SRID: 3116) al nuevo Origen Nacional (SRID: 9377).</p>
            <div class="code-block-container">
                <button class="copy-button">Copiar</button>
                <pre><code class="language-sql">SELECT ST_Transform(geom, 9377) FROM predios_ctm12 LIMIT 1;</code></pre>
            </div>

            <h3>3.3. Asignando un SRID: ST_SetSRID()</h3>
            <p>
                ¡Cuidado! Existe otra función llamada <code>ST_SetSRID(geometria, srid)</code>. Esta función <strong>NO transforma</strong> las coordenadas. Simplemente "etiqueta" la geometría con un SRID. Solo debes usarla cuando tienes datos que no tienen un SRID definido, pero estás seguro de cuáles son sus coordenadas y sistema de referencia originales. Usarla incorrectamente llevará a que tus datos se ubiquen en un lugar erróneo del mapa.
            </p>
            <p><strong>Ejemplo:</strong> Asignar el SRID 9377 a una geometría que fue creada sin uno, pero sabemos que sus coordenadas corresponden a ese sistema.</p>
            <div class="code-block-container">
                <button class="copy-button">Copiar</button>
                <pre><code class="language-sql">-- Creamos un punto sin SRID, pero sabemos que las coordenadas son del Origen Nacional
SELECT ST_SetSRID(
    ST_MakePoint(4995350, 2015600),
    9377
) AS geometria_con_srid;</code></pre>
            </div>
            <p>
                La estandarización al nuevo Origen Nacional (EPSG:9377) es crucial. Asegurarte de que todos tus datos colombianos estén en este SRID antes de realizar análisis es la mejor práctica para garantizar la validez y precisión de tu trabajo.
            </p>

        </article>
        
        <!-- ===== PIE DE PÁGINA ===== -->
        <footer class="text-center mt-16 pt-8 border-t border-gray-300">
            <p class="text-gray-600">&copy; 2024 Universidad Distrital Francisco José de Caldas. Todos los derechos reservados.</p>
            <p class="text-sm text-gray-500 mt-1">Este material se distribuye bajo la licencia Creative Commons Atribución-CompartirIgual.</p>
        </footer>
    </div>
    <script>
        // Inicializa Highlight.js para resaltar todos los bloques de código
        hljs.highlightAll();

        // Agrega la funcionalidad de copiado a todos los botones
        const copyButtons = document.querySelectorAll('.copy-button');
        copyButtons.forEach(button => {
            button.addEventListener('click', () => {
                const pre = button.parentElement.querySelector('pre > code');
                const textToCopy = pre.innerText;

                // Usamos un textarea temporal para copiar el texto
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    button.innerText = 'Copiado!';
                    button.classList.add('copied');
                } catch (err) {
                    console.error('Error al copiar el texto: ', err);
                    button.innerText = 'Error';
                }
                document.body.removeChild(textArea);

                // Revertir el texto del botón después de 2 segundos
                setTimeout(() => {
                    button.innerText = 'Copiar';
                    button.classList.remove('copied');
                }, 2000);
            });
        });
    </script>
</body>
</html>
